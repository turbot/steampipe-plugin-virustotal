---
title: "Steampipe Table: virustotal_file - Query VirusTotal File Reports using SQL"
description: "Allows users to query VirusTotal File Reports, specifically the detailed file scan reports, providing insights into file's safety information."
---

# Table: virustotal_file - Query VirusTotal File Reports using SQL

VirusTotal is a free service that analyzes suspicious files and URLs to detect types of malware, including viruses, worms, and trojans. It aggregates numerous antivirus products and online scan engines to check for viruses that the user's own antivirus solution may have missed, or to verify against any false positives. VirusTotal inspects items with over 70 antivirus scanners and URL/domain blacklisting services.

## Table Usage Guide

The `virustotal_file` table provides insights into file reports within VirusTotal. As a security analyst, explore file-specific details through this table, including scan results, positives found, and scan date. Utilize it to uncover information about files, such as those with potential threats, the detection ratio, and the verification of scan results.

**Important Notes**
- You must specify either the `path` (ocal path to a file) or the `id` (hash of the file) in the `where` clause to query this table.

## Examples

### Get VirusTotal information for a local file
Determine the safety of a local file by analyzing it with VirusTotal. This is useful for verifying downloaded files and avoiding potential security threats.
Uses a local file to generate the hash to query VirusTotal for information
about the file.

The file will not be uploaded for scanning, but just used to generate the hash
to search existing results.


```sql+postgres
select
  *
from
  virustotal_file
where
  path = '/Users/michael/Downloads/terraform_1.0.1_darwin_amd64.zip';
```

```sql+sqlite
select
  *
from
  virustotal_file
where
  path = '/Users/michael/Downloads/terraform_1.0.1_darwin_amd64.zip';
```

### Get file information by ID
This query allows you to pinpoint the specific details of a file using its unique identifier. It is particularly useful when you need to analyze a file's properties or assess its integrity in a security-focused scenario.

```sql+postgres
select
  *
from
  virustotal_file
where
  id = '8739c76e681f900923b900c9df0ef75cf421d39cabb54650c4b9ad19b6a76d85';
```

```sql+sqlite
select
  *
from
  virustotal_file
where
  id = '8739c76e681f900923b900c9df0ef75cf421d39cabb54650c4b9ad19b6a76d85';
```

### List alternate names for a file
This query helps you uncover the alternate names associated with a specific file, which can be useful in identifying potential risks or anomalies associated with that file. This can aid in cybersecurity efforts, ensuring that files are properly identified and assessed for potential threats.

```sql+postgres
select
  jsonb_array_elements_text(names) as name
from
  virustotal_file
where
  id = '8739c76e681f900923b900c9df0ef75cf421d39cabb54650c4b9ad19b6a76d85'
order by
  name;
```

```sql+sqlite
select
  json_each.value as name
from
  virustotal_file,
  json_each(names)
where
  id = '8739c76e681f900923b900c9df0ef75cf421d39cabb54650c4b9ad19b6a76d85'
order by
  name;
```

### Find all scanner results by engine
Explore the variety of scanner results associated with a specific file. This query is useful in identifying and understanding the different categories of analysis results generated by various engines, aiding in comprehensive security assessment.

```sql+postgres
select
  analysis.key as engine,
  analysis.value ->> 'category' as result
from
  virustotal.virustotal_file,
  jsonb_each(last_analysis_results) as analysis
where
  id = '8739c76e681f900923b900c9df0ef75cf421d39cabb54650c4b9ad19b6a76d85'
order by
  engine;
```

```sql+sqlite
select
  analysis.key as engine,
  json_extract(analysis.value, '$.category') as result
from
  virustotal.virustotal_file,
  json_each(last_analysis_results) as analysis
where
  id = '8739c76e681f900923b900c9df0ef75cf421d39cabb54650c4b9ad19b6a76d85'
order by
  engine;
```